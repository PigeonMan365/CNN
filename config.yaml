# MalNet-FocusAug configuration (cleaned & complete)
# --------------------------------------------------
paths:
  input_roots: ["dataset/input"]
  images_root: "dataset/output"
  logs_root: "logs"
  conversion_log: "logs/conversion_log.csv"
  tmp_root: "tmp"
  cache_root: "cache"
  cache_max_bytes: "10GB"

train_io:
  data_csv: "logs/conversion_log.csv"
  images_root: "dataset/output"
  runs_root: "runs"
  run_index: "logs/run_index.json"
  checkpoints_root: null
  tensorboard_root: null

training:
  # ===== Metrics & operating point =====
  metrics:
    primary_global: pr_auc         # or roc_auc
    operating_point:
      type: fpr_budget
      value: 0.001                 # 0.1% FPR

  # ===== Splits =====
  kfold: 3
  holdout: 20                      # used when kfold == 1

  # ===== Batching & imbalance =====
  batch_size: 8
  oversample_pos_range: "0.05-0.10"  # ≈1:19...1:9 positives per batch

  # ===== Optimizer & schedule =====
  optimizer: adamw                 # adam | adamw
  scheduler: onecycle              # none | onecycle
  max_lr: auto                     # "auto" or a float
  weight_decay: 0.0001
  grad_clip: 1.0

  # ===== Performance =====
  epochs: 3                        # <— correct key; trainer reads this
  num_workers: 4                   # trainer will force 0 on Windows automatically
  prefetch_batches: 2
  pin_memory: false
  persistent_workers: true
  amp: false
  device: auto                     # auto | cpu | cuda
  default_mode: compress  # or truncate, otherwise defaults to both


  # ===== Optional compile =====
  torch_compile: false

  # ===== Resume knob (future) =====
  allow_resume: true

  # ===== Exports =====
  export_root: "export_models"
